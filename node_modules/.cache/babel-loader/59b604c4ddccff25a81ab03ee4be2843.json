{"ast":null,"code":"var _jsxFileName = \"D:\\\\Cardapio2021\\\\src\\\\GlobalContext.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport firebase from './Components/Firebase/firebase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const GlobalContext = /*#__PURE__*/React.createContext();\nexport const GlobalStorage = ({\n  children\n}) => {\n  _s();\n\n  const [data, setData] = React.useState([]);\n  const [listProducts, setListProducts] = React.useState([]);\n  const [openCart, setOpenCart] = React.useState(false);\n  const [openObs, setOpenObs] = React.useState(false);\n  const [obs, setObs] = React.useState(null);\n  const [idObs, setIdObs] = React.useState(null);\n  const [cart, setCart] = React.useState([]);\n  const [total, setTotal] = React.useState(0);\n  const [user, setUser] = React.useState(null);\n  const [typeBuy, setTypeBuy] = React.useState('');\n  const [cep, setCep] = React.useState('');\n  const [number, setNumber] = React.useState('');\n  const [complement, setComplement] = React.useState('');\n  const [typePayment, setTypePayment] = React.useState('');\n  const [address, setAddress] = React.useState(null);\n  const [order, setOrder] = React.useState('');\n\n  function addCart(item) {\n    item.quantity = 1;\n    item.currentPrice = item.price;\n    item.isSelected = true;\n    setCart(oldArray => [...oldArray, item]);\n  } // add note to cart item\n\n\n  function addObs(id) {\n    let indexItem = cart.map(e => e.id).indexOf(id);\n    let updatedCart = [...cart];\n    updatedCart[indexItem].obs = obs;\n    setCart(updatedCart);\n  }\n\n  function incrementItem(item) {\n    let indexItem = cart.map(e => e.id).indexOf(item.id);\n    let updatedCart = [...cart];\n    updatedCart[indexItem].quantity = updatedCart[indexItem].quantity + 1;\n    updatedCart[indexItem].currentPrice = updatedCart[indexItem].currentPrice + updatedCart[indexItem].price;\n    setCart(updatedCart);\n  }\n\n  function decrementItem(item) {\n    let indexItem = cart.map(e => e.id).indexOf(item.id);\n    let updatedCart = [...cart];\n    updatedCart[indexItem].quantity = updatedCart[indexItem].quantity - 1;\n    updatedCart[indexItem].currentPrice = updatedCart[indexItem].currentPrice - updatedCart[indexItem].price;\n\n    if (updatedCart[indexItem].quantity === 0) {\n      updatedCart[indexItem].isSelected = false;\n      updatedCart.splice(indexItem, 1);\n      setCart(updatedCart);\n    }\n\n    setCart(updatedCart);\n  }\n\n  const getProducts = async category => {\n    const response = await fetch(`https://my-json-server.typicode.com/danielmafra/api/${category}`);\n    const json = await response.json();\n    setData(json); // const firestoreRef = firebase\n    //   .firestore()\n    //   .collection('Loja')\n    //   .doc('deliverynowhats')\n    //   .collection('Categorias')\n    //   .doc(category)\n    //   .collection('Sucos')\n    // const unsub = firestoreRef.onSnapshot(getCollection)\n    // return () => {\n    //   unsub()\n    // }\n  };\n\n  function getCollection(querySnapshot) {\n    const array = [];\n    querySnapshot.forEach(res => {\n      const {\n        title,\n        price,\n        img,\n        offer,\n        description,\n        id\n      } = res.data();\n      array.push({\n        doc: res.id,\n        id,\n        title,\n        price,\n        description,\n        img,\n        offer\n      });\n      const novo = array.map(item => ({\n        id: item.id,\n        title: item.title,\n        img: item.img,\n        price: item.price,\n        description: item.description,\n        offer: item.offer\n      }));\n      console.log(novo);\n      setData(novo);\n    });\n  }\n\n  async function getCep(cep) {\n    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);\n    const json = await response.json();\n    setAddress({\n      rua: json.logradouro,\n      cidade: json.localidade,\n      bairro: json.bairro,\n      uf: json.uf,\n      cep: json.cep\n    });\n  } // wait for the CEP to be filled in with 8 digits to make the request\n\n\n  React.useEffect(() => {\n    if (cep.length >= 8) {\n      getCep(cep);\n    }\n  }, [cep]); // watch the cart changes to calculate the total price.\n\n  React.useEffect(() => {\n    if (cart.length > 0) {\n      const prices = cart.map(item => item.currentPrice);\n      setTotal(prices.reduce((a, b) => a + b));\n    }\n  }, [cart]); // save the address in localStorage after finalizing the order\n\n  React.useEffect(() => {\n    if (typeBuy === 'delivery') {\n      window.localStorage.setItem('address', JSON.stringify(order.address));\n    }\n  }, [order]);\n  React.useEffect(() => {\n    setListProducts(data);\n  }, [data]); // loads product list and default localStorage address\n\n  React.useEffect(() => {\n    async function loadData() {\n      const response = await fetch('https://my-json-server.typicode.com/danielmafra/api/Bebidas');\n      const json = await response.json();\n      setData(json);\n    }\n\n    loadData();\n    const addressDefault = window.localStorage.getItem('address');\n\n    if (addressDefault !== '' && addressDefault !== null && addressDefault !== undefined) {\n      setUser(JSON.parse(addressDefault));\n    } else {\n      setUser(null);\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(GlobalContext.Provider, {\n    value: {\n      getProducts,\n      listProducts,\n      addCart,\n      cart,\n      total,\n      incrementItem,\n      decrementItem,\n      user,\n      setUser,\n      typeBuy,\n      setTypeBuy,\n      cep,\n      setCep,\n      number,\n      setNumber,\n      complement,\n      setComplement,\n      typePayment,\n      setTypePayment,\n      address,\n      setAddress,\n      order,\n      setOrder,\n      openCart,\n      setOpenCart,\n      openObs,\n      setOpenObs,\n      idObs,\n      setIdObs,\n      obs,\n      setObs,\n      addObs\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 171,\n    columnNumber: 5\n  }, this);\n};\n\n_s(GlobalStorage, \"XqntDUtvCCUAFqtYvjl4FZ/yS+8=\");\n\n_c = GlobalStorage;\n\nvar _c;\n\n$RefreshReg$(_c, \"GlobalStorage\");","map":{"version":3,"sources":["D:/Cardapio2021/src/GlobalContext.js"],"names":["React","firebase","GlobalContext","createContext","GlobalStorage","children","data","setData","useState","listProducts","setListProducts","openCart","setOpenCart","openObs","setOpenObs","obs","setObs","idObs","setIdObs","cart","setCart","total","setTotal","user","setUser","typeBuy","setTypeBuy","cep","setCep","number","setNumber","complement","setComplement","typePayment","setTypePayment","address","setAddress","order","setOrder","addCart","item","quantity","currentPrice","price","isSelected","oldArray","addObs","id","indexItem","map","e","indexOf","updatedCart","incrementItem","decrementItem","splice","getProducts","category","response","fetch","json","getCollection","querySnapshot","array","forEach","res","title","img","offer","description","push","doc","novo","console","log","getCep","rua","logradouro","cidade","localidade","bairro","uf","useEffect","length","prices","reduce","a","b","window","localStorage","setItem","JSON","stringify","loadData","addressDefault","getItem","undefined","parse"],"mappings":"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","sourcesContent":["import React from 'react'\nimport firebase from './Components/Firebase/firebase'\n\nexport const GlobalContext = React.createContext()\n\nexport const GlobalStorage = ({ children }) => {\n  const [data, setData] = React.useState([])\n  const [listProducts, setListProducts] = React.useState([])\n  const [openCart, setOpenCart] = React.useState(false)\n  const [openObs, setOpenObs] = React.useState(false)\n  const [obs, setObs] = React.useState(null)\n  const [idObs, setIdObs] = React.useState(null)\n  const [cart, setCart] = React.useState([])\n  const [total, setTotal] = React.useState(0)\n  const [user, setUser] = React.useState(null)\n  const [typeBuy, setTypeBuy] = React.useState('')\n  const [cep, setCep] = React.useState('')\n  const [number, setNumber] = React.useState('')\n  const [complement, setComplement] = React.useState('')\n  const [typePayment, setTypePayment] = React.useState('')\n  const [address, setAddress] = React.useState(null)\n  const [order, setOrder] = React.useState('')\n\n  function addCart(item) {\n    item.quantity = 1\n    item.currentPrice = item.price\n    item.isSelected = true\n    setCart((oldArray) => [...oldArray, item])\n  }\n\n  // add note to cart item\n  function addObs(id) {\n    let indexItem = cart.map((e) => e.id).indexOf(id)\n    let updatedCart = [...cart]\n    updatedCart[indexItem].obs = obs\n    setCart(updatedCart)\n  }\n\n  function incrementItem(item) {\n    let indexItem = cart.map((e) => e.id).indexOf(item.id)\n    let updatedCart = [...cart]\n    updatedCart[indexItem].quantity = updatedCart[indexItem].quantity + 1\n    updatedCart[indexItem].currentPrice =\n      updatedCart[indexItem].currentPrice + updatedCart[indexItem].price\n    setCart(updatedCart)\n  }\n\n  function decrementItem(item) {\n    let indexItem = cart.map((e) => e.id).indexOf(item.id)\n    let updatedCart = [...cart]\n    updatedCart[indexItem].quantity = updatedCart[indexItem].quantity - 1\n    updatedCart[indexItem].currentPrice =\n      updatedCart[indexItem].currentPrice - updatedCart[indexItem].price\n    if (updatedCart[indexItem].quantity === 0) {\n      updatedCart[indexItem].isSelected = false\n      updatedCart.splice(indexItem, 1)\n      setCart(updatedCart)\n    }\n    setCart(updatedCart)\n  }\n\n  const getProducts = async (category) => {\n    const response = await fetch(\n      `https://my-json-server.typicode.com/danielmafra/api/${category}`\n    )\n    const json = await response.json()\n    setData(json)\n\n    // const firestoreRef = firebase\n    //   .firestore()\n    //   .collection('Loja')\n    //   .doc('deliverynowhats')\n    //   .collection('Categorias')\n    //   .doc(category)\n    //   .collection('Sucos')\n\n    // const unsub = firestoreRef.onSnapshot(getCollection)\n\n    // return () => {\n    //   unsub()\n    // }\n  }\n\n  function getCollection(querySnapshot) {\n    const array = []\n    querySnapshot.forEach((res) => {\n      const { title, price, img, offer, description, id } = res.data()\n      array.push({\n        doc: res.id,\n        id,\n        title,\n        price,\n        description,\n        img,\n        offer,\n      })\n      const novo = array.map((item) => ({\n        id: item.id,\n        title: item.title,\n        img: item.img,\n        price: item.price,\n        description: item.description,\n        offer: item.offer,\n      }))\n      console.log(novo)\n      setData(novo)\n    })\n  }\n\n  async function getCep(cep) {\n    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`)\n    const json = await response.json()\n    setAddress({\n      rua: json.logradouro,\n      cidade: json.localidade,\n      bairro: json.bairro,\n      uf: json.uf,\n      cep: json.cep,\n    })\n  }\n\n  // wait for the CEP to be filled in with 8 digits to make the request\n  React.useEffect(() => {\n    if (cep.length >= 8) {\n      getCep(cep)\n    }\n  }, [cep])\n\n  // watch the cart changes to calculate the total price.\n  React.useEffect(() => {\n    if (cart.length > 0) {\n      const prices = cart.map((item) => item.currentPrice)\n      setTotal(prices.reduce((a, b) => a + b))\n    }\n  }, [cart])\n\n  // save the address in localStorage after finalizing the order\n  React.useEffect(() => {\n    if (typeBuy === 'delivery') {\n      window.localStorage.setItem('address', JSON.stringify(order.address))\n    }\n  }, [order])\n\n  React.useEffect(() => {\n    setListProducts(data)\n  }, [data])\n\n  // loads product list and default localStorage address\n  React.useEffect(() => {\n    async function loadData() {\n      const response = await fetch(\n        'https://my-json-server.typicode.com/danielmafra/api/Bebidas'\n      )\n      const json = await response.json()\n      setData(json)\n    }\n    loadData()\n    const addressDefault = window.localStorage.getItem('address')\n    if (\n      addressDefault !== '' &&\n      addressDefault !== null &&\n      addressDefault !== undefined\n    ) {\n      setUser(JSON.parse(addressDefault))\n    } else {\n      setUser(null)\n    }\n  }, [])\n\n  return (\n    <GlobalContext.Provider\n      value={{\n        getProducts,\n        listProducts,\n        addCart,\n        cart,\n        total,\n        incrementItem,\n        decrementItem,\n        user,\n        setUser,\n        typeBuy,\n        setTypeBuy,\n        cep,\n        setCep,\n        number,\n        setNumber,\n        complement,\n        setComplement,\n        typePayment,\n        setTypePayment,\n        address,\n        setAddress,\n        order,\n        setOrder,\n        openCart,\n        setOpenCart,\n        openObs,\n        setOpenObs,\n        idObs,\n        setIdObs,\n        obs,\n        setObs,\n        addObs,\n      }}\n    >\n      {children}\n    </GlobalContext.Provider>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}